var currentQuestion=0,lastQuestion=questions.length-1,local=!document.location.hostname;function storyController(e){current=0,createMessage(e[0].question)}function createMessage(e,t,a){a=void 0!==a?a:0;var n=(t=void 0!==t?t:0)>0?calculateDelay(e[t-1]):1e3;!a&&questions[currentQuestion].intro&&0==t&&(n=50),setTimeout((function(){if(t>=e.length)return a?(currentQuestion++,createMessage(questions[currentQuestion].question),1):(createAnswerField(n),1);$("#chat-container").append('<div class="msg_history"><div class="incoming_msg"><div class="received_msg"><div class="animated fadeInUp bubbleLeft received_msg"><p>'+e[t]+"</p></div></div></div>"),"chat"==$(".active").attr("id")&&smoothScrollBottom(),t++,createMessage(e,t,a)}),n)}function createAnswerField(){if(questions[currentQuestion].ending)return 1;$("#chat-container").append('<div class="outgoing_msg" id="answer-container"> <div class="line animated fadeInUp bubbleRight sent_msg p"><form action="#" onsubmit="return false;"><label for="answer"></label><input required="required" novalidate="novalidate" autocomplete="on" min="2" max="40" formnovalidate="formnovalidate" spellcheck="true" autofocus="autofocus" type="text" name="answer" id="answer" class="" value="" placeholder="Type responseâ€¦"></form></div></div>'),$("#answer").keyup((function(e){if(13==e.keyCode){var t=$.trim($("#answer").val());""!=t?($("#answer-container").remove(),createAnswerMessage(t)):($("#answer").removeClass("shake").removeClass("fadeInUp"),$("#answer").addClass("shake"),$("#answer").one("webkitAnimationEnd mozAnimationEnd MSAnimationEnd oanimationend animationend",(function(){$(this).removeClass("shake").removeClass("fadeInUp")})))}})),$("#answer").focus(),"chat"==$(".active").attr("id")&&smoothScrollBottom()}function createAnswerMessage(e){$("#chat-container").append('<div class="outgoing_msg"><div class="animated fadeInUp bubbleRight sent_msg"><p>'+e+"</p></div></div>"),local&&(console.log(e),console.log(questions[currentQuestion]));questions[currentQuestion].name,String(Date.now());createMessage(findResponseForAnswer(e,questions[currentQuestion].answers),0,1)}function findResponseForAnswer(e,t){for(key in t)if(e.toLowerCase().match(key))return t[key].replies;return t.default.replies}function calculateDelay(e){var t=218*e.split(" ").length;return t=t<654?t+400:t}function smoothScrollBottom(){$(".chatbox__body").stop().animate({scrollTop:$(".chatbox__body")[0].scrollHeight},1500)}function tabHandler(){$tab=$("#menu ul li"),$content=$(".content"),$defaultTab=$("#chat");$defaultTab.addClass("active"),$("#"+$defaultTab.attr("data-content")).addClass("activeContent"),$tab.click((function(){if(!$(this).hasClass("active")){!1;var e="#"+$(this).attr("data-content");$tab.removeClass("active"),$(this).addClass("active"),$(".activeContent")!=$(e)&&$(".activeContent").hide().removeClass("activeContent"),$(e).show().addClass("activeContent"),"chat"==$(".active").attr("id")&&(smoothScrollBottom(),$(".message").each((function(){$(this).removeClass("tada").removeClass("fadeInUp").addClass("fadeIn")}))),"about"==$(".active").attr("id")&&$("html,body").animate({scrollTop:0},0)}}))}$(document).ready((function(){new storyController(questions),new tabHandler}));
